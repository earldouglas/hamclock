Based heavily on https://github.com/Theldus/wsServer -- many thanks
